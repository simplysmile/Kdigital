$.fn.dslide=function(M){return this.each(function(){var g=$(this);if(!g.hasClass("dslide-installed")){var f=$.extend(!0,{captionParent:null,paginationParent:null,paginationCounter:!1,paginationCounterParent:null,randomStart:!1,startIndex:0,reloadChange:!1,buttonsWrapper:!0,hideButtonsOnMouseOut:!1,hidePaginationOnMouseOut:!1,stopWhenHover:!1,stopWhenSlide:!0,slideDuration:600,dissolve:!1,dynamicHeight:!1,dynamicHeighting:!1,loop:!0,touch:!0,backgroundSize:"cover",onslide:function(t){},onslidecomplete:function(t){},player:!1,playInterval:0},M);g.attr("data-dslide-caption-parent")&&(f.captionParent=$(g.attr("data-dslide-caption-parent"))),g.attr("data-dslide-pagination-parent")&&(f.paginationParent=$(g.attr("data-dslide-pagination-parent"))),g.attr("data-dslide-pagination-counter")&&(f.paginationCounter="true"==g.attr("data-dslide-pagination-counter")),g.attr("data-dslide-pagination-counter-parent")&&(f.paginationCounterParent=$(g.attr("data-dslide-pagination-counter-parent"))),g.attr("data-dslide-random-start")&&(f.randomStart="true"==g.attr("data-dslide-random-start")),g.attr("data-dslide-start-index")&&(f.startIndex=parseInt(g.attr("data-dslide-start-index"))),g.attr("data-dslide-reload-change")&&(f.reloadChange="true"==g.attr("data-dslide-reload-change")),g.attr("data-dslide-buttons-wrapper")&&(f.buttonsWrapper="true"==g.attr("data-dslide-buttons-wrapper")),g.attr("data-dslide-hide-buttons-on-mouse-out")&&(f.hideButtonsOnMouseOut="true"==g.attr("data-dslide-hide-buttons-on-mouse-out")),g.attr("data-dslide-hide-pagination-on-mouse-out")&&(f.hidePaginationOnMouseOut="true"==g.attr("data-dslide-hide-pagination-on-mouse-out")),g.attr("data-dslide-stop-when-hover")&&(f.stopWhenHover="true"==g.attr("data-dslide-stop-when-hover")),g.attr("data-dslide-stop-when-slide")&&(f.stopWhenSlide="true"==g.attr("data-dslide-stop-when-slide")),g.attr("data-dslide-slide-duration")&&(f.slideDuration=parseInt(g.attr("data-dslide-slide-duration"))),g.attr("data-dslide-dissolve")&&(f.dissolve="true"==g.attr("data-dslide-dissolve")),g.attr("data-dslide-dynamic-height")&&(f.dynamicHeight="true"==g.attr("data-dslide-dynamic-height")),g.attr("data-dslide-dynamic-heighting")&&(f.dynamicHeighting="true"==g.attr("data-dslide-dynamic-heighting")),g.attr("data-dslide-loop")&&(f.loop="true"==g.attr("data-dslide-loop")),g.attr("data-dslide-touch")&&(f.touch="true"==g.attr("data-dslide-touch")),g.attr("data-dslide-background-size")&&(f.backgroundSize=g.attr("data-dslide-background-size")),g.attr("data-dslide-player")&&(f.player="true"==g.attr("data-dslide-player")),g.attr("data-dslide-play-interval")&&(f.playInterval=parseInt(g.attr("data-dslide-play-interval")));var v=!1,m=!!f.dynamicHeighting;g.addClass("dslide"),g.hover(function(){g.addClass("dslide-hover")},function(){g.removeClass("dslide-hover")});var C=g.children().addClass("dslide-item");f.dissolve&&C.addClass("dslide-item-dissolve");var r=$("<div />").addClass("dslide-zone").appendTo(g),b=$("<div />").addClass("dslide-slider").appendTo(r).append(C);if(f.dissolve||b.addClass("slide-"),f.dynamicHeight){var t=C.filter(":first"),a=t.attr("data-width")?parseInt(t.attr("data-width")):t.outerWidth(),e=t.attr("data-height")?parseInt(t.attr("data-height")):t.outerHeight();g.css("padding-bottom",e/a*100+"%")}var y=$("<div />");f.paginationParent?(y.appendTo(f.paginationParent),C.length<2&&f.paginationParent.hide()):y.appendTo(g),y.addClass("dslide-pagination");var d=$("<div />");if(f.paginationCounter){d.addClass("dslide-pagination-counter").appendTo(f.paginationCounterParent?f.paginationCounterParent:g);$("<span />").addClass("current").appendTo(d);$("<span />").addClass("dslide-pc-divider").text("/").appendTo(d),"1"==$("<span />").addClass("total").text(C.length).appendTo(d).text()&&d.remove(),C.length<2&&f.paginationCounterParent&&f.paginationCounterParent.hide()}var i,k=$("<ul />").appendTo(y),n=$("<div />").addClass("dslide-player");f.player&&(n.appendTo(y),n.click(function(){g.hasClass("playing-")?g.trigger("pause"):g.trigger("play")})),f.buttonsWrapper&&(i=$("<div />").addClass("dslide-buttons").appendTo(g),C.length<=1&&i.css("visibility","hidden"));var o=$('<a href="#"><span class="fa fa-fw fa-angle-left"></span></a>').click(function(t){var a=y.find(".dslide-current").prev().children("a");0==a.length&&(a=y.find("a:last")),a.click(),t.preventDefault()}).appendTo(f.buttonsWrapper?i:g).addClass("dslide-prev"),l=$('<a href="#"><span class="fa fa-fw fa-angle-right"></span></a>').click(function(t){var a=y.find(".dslide-current").next().children("a");0==a.length&&(a=y.find("a:first")),a.click(),t.preventDefault()}).appendTo(f.buttonsWrapper?i:g).addClass("dslide-next");if(C.length<2&&f.buttonsWrapper&&i.hide(),f.touch&&"undefined"!=typeof Hammer){var u,p,h,s=new Hammer.Manager(g.get(0));s.add(new Hammer.Pan({direction:Hammer.DIRECTION_HORIZONTAL}));var c="panend",I=null;function w(t){if("pan"==c)if(c="panend",t.preventDefault(),f.dissolve)v=!1,0<t.deltaX?o.click():l.click();else{var a=0<t.deltaX?p:h,e=!1;(a.hasClass("dslide-item-tmp")||Math.abs(r.offset().left-u.offset().left)<r.width()/10)&&(e=!0);var d=f.slideDuration,i=Math.abs(t.deltaX/t.velocityX);if(i<100&&(i=100),i<f.slideDuration&&(d=i),f.dynamicHeight&&!e){f.dynamicHeighting&&a.addClass("heighting-");var n=a.attr("data-width")?parseInt(a.attr("data-width")):a.outerWidth(),s=a.attr("data-height")?parseInt(a.attr("data-height")):a.outerHeight();g.animate({paddingBottom:s/n*100+"%"},{queue:!1,complete:function(){f.dynamicHeighting&&a.removeClass("heighting-")},duration:f.slideDuration})}b.animate({left:e?"-100%":0<t.deltaX?"0":"-200%"},{duration:d,complete:function(){if(e)x.not(u.show()).not(p.show()).not(h.show()).hide();else{var t=a.data("dslide-page");t&&t.trigger("mark-current"),C.not(a.addClass("dslide-current-target")).removeClass("dslide-current-target"),f.reloadChange&&(u.html(u.html()),z()),x.not(a.show()).not(a.prev().show()).not(a.next().show()).hide()}b.css("left",""),v=!1,f.onslidecomplete(g)}})}}s.on("panstart",function(t){if(!v){if("panend"!=c)return c="pan",void w(t);c="panstart",v=!0,f.dissolve||(g.trigger("pause"),u=C.filter(".dslide-current-target"),p=u.prev(),h=u.next())}}).on("pan",function(t){if(("panstart"==c||"pan"==c)&&(c="pan",Math.abs(t.deltaY)<50&&Math.abs(t.deltaX)>Math.abs(t.deltaY)&&(t.preventDefault(),!f.dissolve))){var a=t.deltaX/r.width()*100-100;b.css("left",a+"%"),I&&clearTimeout(I),I=setTimeout(function(){w(t)},100)}}).on("panend",w)}f.buttonsWrapper&&f.hideButtonsOnMouseOut&&(g.hover(function(){i.animate({opacity:"1"},{queue:!1})},function(){i.animate({opacity:"0"},{queue:!1})}),i.css("opacity","0"),o.hide(),l.hide());var T=0;f.dissolve&&C.css({opacity:"0","z-index":"0"}),$("<div />").addClass("dslide-item dslide-item-tmp").prependTo(b),$("<div />").addClass("dslide-item dslide-item-tmp").appendTo(b);var x=b.children(".dslide-item");if(C.each(function(){var c=$(this).data("dslide-index",T);c.css({backgroundSize:f.backgroundSize});var t=$("<li />").attr("data-dslide-index",T+1).appendTo(k),a=$('<a href="#"></a>');f.captionParent&&t.data("caption",c.find(".caption").html());var e=c.attr("data-dslide-thumbnail");e&&(y.removeClass("dslide-pagination").addClass("dslide-thumbnails"),k.parent().hasClass("dslide-thumbnails-inner")||k.wrap('<div class="dslide-thumbnails-inner" />'),a.css({backgroundImage:"url("+e+")"})),c.data("dslide-page",a),a.data("dslide-target",c),a.click(function(t){t.preventDefault(),f.stopWhenHover||g.trigger("pause"),f.stopWhenSlide&&g.trigger("pause"),$(this).trigger("run")}).data("dslide-target",c).bind("run",function(t){var a=g.find(".dslide-current-target");if(!(0<a.length&&0<c.length&&a.get(0)==c.get(0)||v)){v=!0;var e=a.html();if(C.not(c.addClass("dslide-current-target")).removeClass("dslide-current-target"),f.dynamicHeight){f.dynamicHeighting&&c.addClass("heighting-");var d=c.attr("data-width")?parseInt(c.attr("data-width")):c.outerWidth(),i=c.attr("data-height")?parseInt(c.attr("data-height")):c.outerHeight();setTimeout(function(){g.animate({paddingBottom:i/d*100+"%"},{queue:!1,complete:function(){f.dynamicHeighting&&(c.removeClass("heighting-"),m=!1)},duration:m?0:f.slideDuration})},1)}if(0<c.find(".background-is-bright").length?g.removeClass("background-is-dark").addClass("background-is-bright"):0<c.find(".background-is-dark").length?g.removeClass("background-is-bright").addClass("background-is-dark"):g.removeClass("background-is-bright").removeClass("background-is-dark"),f.dissolve)C.not(c).css("z-index","0"),f.onslide(g),c.show().css({backgroundSize:f.backgroundSize,opacity:"0","z-index":"1"}).animate({opacity:"1"},{complete:function(){f.reloadChange&&(a.html(e),z()),C.not(c).hide(),v=!1,f.onslidecomplete(g)},queue:!1,duration:f.slideDuration});else{var n=a.data("dslide-index"),s=c.data("dslide-index"),r=0==a.length||n<s,o=a.prev(),l=a.next();(r?l:o).data("dslide-index")!=s&&(r?l=c:o=c),x.not(a.show()).not(o.show()).not(l.show()).hide(),f.onslide(g),b.animate({left:r?"-200%":"0"},{complete:function(){f.reloadChange&&(a.html(e),z()),x.not(c.show()).not(c.prev().show()).not(c.next().show()).hide(),b.css({left:""}),v=!1,f.onslidecomplete(g)},queue:!1,duration:0<a.length?f.slideDuration:0})}if($(this).trigger("mark-current"),y.hasClass("dslide-thumbnails")){var u=y.find(".dslide-thumbnails-inner"),p=y.find(".dslide-current"),h=p.offset().left+p.outerWidth()/2-k.offset().left-y.outerWidth()/2;u.animate({scrollLeft:h})}}}).bind("mark-current",function(t){k.find("li").not($(this).parent().addClass("dslide-current")).removeClass("dslide-current"),f.paginationCounter&&d.find(".current").text(k.find(".dslide-current").attr("data-dslide-index")),f.captionParent&&f.captionParent.html(k.find(".dslide-current").data("caption")),this!=k.find("a:first").get(0)||f.loop?o.fadeIn():o.fadeOut(),this!=k.find("a:last").get(0)||f.loop?l.fadeIn():l.fadeOut()}).text(T+1).appendTo(t).each(function(){"undefined"!=typeof DD_belatedPNG&&DD_belatedPNG.fixPng(this)}).focus(function(){$(this).blur()}),T++}).hide(),C.length<2&&(o.remove(),l.remove(),y.hide()),f.hidePaginationOnMouseOut&&(y.css("opacity","0"),g.hover(function(){y.animate({opacity:"1"},{queue:!1})},function(){y.animate({opacity:"0"},{queue:!1})})),k.children("li:first").addClass("first"),k.children("li:last").addClass("last"),g.parent().find("a").focus(function(){$(this).blur()}),f.randomStart){var H=k.find("a"),D=Math.floor(Math.random()*H.length),P=f.slideDuration;f.slideDuration=0,setTimeout(function(){$(H.get(D)).trigger("run"),f.slideDuration=P},1)}else{(H=k.find("a")).length<=f.startIndex&&(f.startIndex=0),$(H.get(f.startIndex)).trigger("run")}if(0<f.playInterval){var W=null;function O(){if(0!=f.playInterval){var t=y.find(".dslide-current").next().children("a");0==t.length&&(t=k.find("a:first")),f.stopWhenHover&&g.hasClass("dslide-hover")||(t.trigger("run"),W&&clearTimeout(W),W=setTimeout(O,f.playInterval))}}f.stopWhenHover&&g.mouseout(function(){W&&clearTimeout(W),W=setTimeout(O,f.playInterval)}),W=setTimeout(O,f.playInterval),g.bind("pause",function(){f.playInterval=0,g.removeClass("playing-").addClass("stopped-"),W&&clearTimeout(W)}),g.bind("play",function(){g.attr("data-dslide-play-interval")&&(f.playInterval=parseInt(g.attr("data-dslide-play-interval")),g.removeClass("stopped-").addClass("playing-"),O())}),g.removeClass("stopped-").addClass("playing-")}g.addClass("dslide-installed")}function z(){$.fn.dvideo?(C.children("a.video-image").each(function(){var a=$(this),e=a.parent().addClass("opacity-0");e.find(".dcore-zoom-cover")&&(e=e.find(".dcore-zoom-cover")),e.hasClass("dvideo-image-installed")||$.dvideoImage(a.attr("href"),function(t){e.css("background-image","url("+t+")").addClass("dvideo-image-installed"),a.parent().imagesLoaded({background:!0},function(){a.parent().addClass("opacity-1")})})}),C.children("a.video").unbind("click").click(function(t){t.preventDefault();var a=$(this).attr("href"),e=$("<div />").addClass("dslide-video").appendTo(g.trigger("pause"));y.fadeOut(),i.fadeOut(),$("<div />").addClass("dslide-video-view").appendTo(e).dvideo(a,!0).hide().fadeIn(),$("<a />").addClass("dslide-video-close no-pjax").appendTo(e).click(function(t){t.preventDefault(),e.fadeOut(function(){e.remove()}),y.fadeIn(),i.fadeIn()})})):C.children("a.video").attr("target","_blank")}})},$(document).bind("dofirst",function(t,a){$(a).find(".dslide").dslide()}),$(document).bind("doresize",function(){$('.dslide[data-dslide-dynamic-heighting="true"]').each(function(){var t=$(this),a=t.find(".dslide-current-target");a.addClass("heighting-");var e=a.attr("data-width")?parseInt(a.attr("data-width")):a.outerWidth(),d=a.attr("data-height")?parseInt(a.attr("data-height")):a.outerHeight();t.css({paddingBottom:d/e*100+"%"}),a.removeClass("heighting-")})});
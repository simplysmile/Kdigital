$.dmodal=function(o){$(":focus").blur(),o=$.extend(!0,{htmlClone:!0,allowClose:!0,closeButton:!0,close:function(){},keycontrol:function(t,o){},callback:function(t){return $("<div />").appendTo(t)}},o);var t,a,e,d,n=$("body"),l=$(window).scrollTop();o.htmlClone&&(t=n.children().not(".cke, .cke_screen_reader_only"),a=$("<div />").addClass("dmodal-html-clone").appendTo(n),e=$("<div />").addClass("dmodal-body-clone").css({top:-l,paddingTop:n.cssv("padding-top"),paddingRight:n.cssv("padding-right"),paddingbottom:n.cssv("padding-bottom"),paddingLeft:n.cssv("padding-left"),marginTop:n.cssv("margin-top"),marginRight:n.cssv("margin-right"),marginbottom:n.cssv("margin-bottom"),marginLeft:n.cssv("margin-left")}).appendTo(a),t.appendTo(e),$(window).scrollTop(0)),o.htmlClone&&(d=$(".stickyfill")).each(function(){$(this).attr("data-top",$(this).cssv("top")).css({top:"auto"})});var i=$("<div />").addClass("dmodal-wrap").appendTo(n);o.htmlClone&&i.addClass("html-cloned-");$("<div />").addClass("dmodal-birdscreen").appendTo(i);var r=$("<div />").addClass("dmodal-outer").appendTo(i),s=$("<div />").addClass("dmodal-inner").appendTo(r).click(function(t){o.allowClose&&t.originalEvent&&c.trigger("dmodal-close")}),c=$("<div />").addClass("dmodal-container").appendTo(s).bind("dmodal-close",function(t){$(document).unbind("keyup",m),o.htmlClone&&a.removeClass("active-"),i.removeClass("active-"),setTimeout(function(){o.close(),i.remove(),o.htmlClone&&(e.children().prependTo(n),a.remove(),$(window).scrollTop(l))},$("html").hasClass("csstransitions")?600:0),o.htmlClone&&(Stickyfill&&Stickyfill.kill(),d.each(function(){$(this).css({position:"static",top:$(this).attr("data-top")}),Stickyfill&&Stickyfill.add(this)}),Stickyfill&&Stickyfill.rebuild())}),f=o.callback(c).click(function(t){t.stopPropagation(),$("html").trigger("click.Outside",t)});if(f.find("a.pjax").click(function(t){t.preventDefault(),t.stopPropagation(),$.pjaxRedirect($(this).attr("href"))}),setTimeout(function(){o.htmlClone&&a.addClass("active-"),i.addClass("active-")},60),o.closeButton){f.find(".dmodal-close").remove();$("<button />").attr("type","button").addClass("dmodal-close").appendTo(f).focus(function(){$(this).blur()}).click(function(t){t.preventDefault(),c.trigger("dmodal-close")})}function m(t){27==t.keyCode&&o.allowClose&&c.trigger("dmodal-close"),o.keycontrol(t,c)}return $(document).keyup(m),c},$.dmodalLoading=function(t){return t=$.extend(!0,{allowClose:!1,closeButton:!1,callback:function(t){return t.css("background","url(/img/loading-large-eee.gif) no-repeat center"),$()}},t),$.dmodal(t)},$.fn.dmodalTrigger=function(t){return this.click(function(t){t.preventDefault();var a=$(this),o=a.attr("href");if(!a.hasClass("dmodal-trigger-ing"))if(o.match(/^#/)){if(0<(d=$($(this).attr("href"))).length){var e=$("<div />").hide().insertAfter(d);d.removeClass("hide"),n(d,function(){},function(){d.addClass("hide").insertBefore(e),e.remove()})}}else if(a.addClass("dmodal-trigger-ing"),"true"==a.attr("data-iframe")){var d=$("<div />").addClass("dmodal-iframe-content");$("<iframe />").attr({src:a.attr("href")}).appendTo(d);n(d,null,function(){"refresh"==a.attr("data-on-close")&&location.reload()})}else $.dget(o,function(t){a.removeClass("dmodal-trigger-ing");var o=$("<div />").html(t);a.attr("data-selector")&&(o=o.find(a.attr("data-selector"))),n(o,function(t){t.dofirst()})},"html");function n(t,a,o){$.dmodal({close:function(){"function"==typeof o&&o(t)},callback:function(o){return o.addClass("normal-scroll"),t.addClass("dmodal-content").appendTo(o),"function"==typeof a&&a(t),t.trigger("dmodal-callback"),t.find("a.dmodal-trigger").click(function(t){t.preventDefault(),o.trigger("dmodal-close")}),t}})}})},$(document).bind("dofirst",function(t,o){$(o).find("a.dmodal-trigger").dmodalTrigger()});